GENESIS TODO
============

This document tracks features and improvements still needed for genesis.

Legend:
  [-] Partial / In Progress
  [ ] Not Started


================================================================================
PENDING FEATURES
================================================================================

Java 11:
  [ ] Annotations on lambda params with var: (@NonNull var x) -> x

Java 21:
  [ ] Record attribute parsing for positional component matching
      Currently pattern variable names must match record component names.
      Should read Record attribute from external class files for position-based matching.

Java 22+:
  [ ] Unnamed variables (JEP 456)
      [ ] int _ = compute(); - discard result
      [ ] for (var _ : list) { } - unused loop variable
      [ ] catch (Exception _) { } - unused exception
      Note: Different from unnamed patterns in switch (already implemented)
  [ ] Statements before super() (JEP 447, preview in 22-24)
      [ ] Allow initialization code before super() call
      Still in preview, may wait for finalization


================================================================================
DEFERRED / WILL NOT IMPLEMENT
================================================================================

  [ ] String templates (JEP 430, 459, 465)
      Withdrawn in Java 23 pending complete redesign.
      The template processor API was considered too complex and is being
      rethought. Wait for the redesigned feature in a future Java version.

  [ ] Better error recovery in parser
      Basic recovery already exists (skip to ; or } on error).
      More sophisticated recovery (multiple errors, smarter sync points)
      would be useful for IDE integration but not critical for CLI use.

  [ ] Type path for nested type annotations (generics, arrays)
      Low priority - rarely used in practice.


================================================================================
KNOWN BUGS
================================================================================

1. Ternary boxing in varargs (Conditional01-03):
   - Ternary expression results in varargs arrays get spurious Integer.valueOf()
   - Stack: [array, idx, String] but then calls Integer.valueOf expecting int
   - Issue in codegen_expr.c array element storage

2. Switch variable scoping (LambdaScope04 testSwitchLocal* tests):
   - Variables declared in case 0 used in default case
   - Genesis doesn't check for possibly-uninitialized variables

3. Varargs method reference with primitive array (MethodReference36):
   - Needs synthetic bridge method to wrap argument in Object[]
   - javac generates lambda$test$N methods that create Object[] wrapper

4. Type constraint violation detection (MethodReference68):
   - Compile-fail test - Genesis doesn't detect the error
   - Generates invalid bytecode instead of compile error

5. Lambda cast to primitive type (TargetType17):
   - Compile-fail test - should error but doesn't

6. Generic constructor Signature attribute:
   - Uses return type instead of V


================================================================================
OPTIONAL IMPROVEMENTS
================================================================================

Refactoring:
  - Split codegen_expr.c (7600+ lines) into smaller modules
  - Replace remaining slist_new/slist_append patterns with slist_push
  - Consider moving resolve_java_lang_class to a utility module

Inner class synthetic accessors:
  - Private member access from inner classes currently requires members
    to be package-private. Full javac compatibility would generate
    synthetic access$N methods for truly private access.
